version: '3.8'
services:
  devcontainer:
    build:
      context: ..
      dockerfile: .devcontainer/Dockerfile
      args:
        BASE_IMAGE: "${DOCKER_LOCAL_REGISTRY}/development"
    image: ${DOCKER_LOCAL_REGISTRY}/vscode-pybackpack
    environment:
      REDIS_URL: ${REDIS_URL}
      MONGODB_URL: ${MONGODB_URL}
    volumes:
      # Mount from the root to access .git in the vscode running in the container.
      - ../../..:/workspace:cached
    command: sleep infinity
    networks:
      - pybackpack_network
  redis:
    image: redis/redis-stack
    networks:
      - pybackpack_network
  mongo:
    image: mongo
    networks:
      - pybackpack_network

networks:
  pybackpack_network:
    driver: bridge
